{% extends "base.html" %}
{% block content %}
<section class="panel">
  <h2>Ingredient summary</h2>
  <table>
    <tbody>
      <!-- Keep key operational fields and hide low-value metadata columns for easier reading. -->
      <tr><th>sku</th><td>{{ summary.ingredient.sku }}</td></tr>
      <tr><th>trade_name_inci</th><td>{{ summary.ingredient.trade_name_inci or "" }}</td></tr>
      <tr><th>supplier</th><td>{{ summary.ingredient.supplier or "" }}</td></tr>
      <tr><th>spec_grade</th><td>{{ summary.ingredient.spec_grade or "" }}</td></tr>
      <tr><th>format</th><td>{{ summary.ingredient.format or "" }}</td></tr>
      <tr><th>pack_size_value</th><td>{{ summary.ingredient.pack_size_value or "" }}</td></tr>
      <tr><th>pack_size_unit</th><td>{{ summary.ingredient.pack_size_unit or "" }}</td></tr>
      <!-- Replace storage metadata fields with a single actionable MSDS download link. -->
      <tr>
        <th>MSDS</th>
        <td>
          {% if summary.ingredient.msds_object_path %}
          <a href="/ingredients/{{ sku }}/msds">Download MSDS</a>
          {% else %}
          No MSDS uploaded
          {% endif %}
        </td>
      </tr>
    </tbody>
  </table>
</section>
<section class="panel">
  <h2>Formulations containing SKU</h2>
  <table>
    <thead><tr><th>Formulation code</th><th>Set code</th><th>Weight code</th><th>Batch variant code</th></tr></thead>
    <tbody>
      {% for row in summary.formulations %}
      <tr>
        <td><a href="/location_codes">{{ row.base_code }}</a></td>
        <td>{{ row.set_code }}</td>
        <td>{{ row.weight_code }}</td>
        <td>{{ row.batch_variant_code }}</td>
      </tr>
      {% else %}
      <tr><td colspan="4">No formulations found</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>
<section class="panel">
  <h2>Pellet bags containing SKU</h2>
  <table>
    <thead><tr><th>Pellet bag code</th><th>Compounding how code</th></tr></thead>
    <tbody>
      {% for row in summary.pellet_bags %}
      <tr>
        <td><a href="/pellet-bags/{{ row.pellet_bag_code }}">{{ row.pellet_bag_code }}</a></td>
        <td>{{ row.compounding_how_code }}</td>
      </tr>
      {% else %}
      <tr><td colspan="2">No pellet bags found</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}
